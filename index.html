<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Listar Produtos Omie</title>
</head>
<body>
  <button id="btnBuscar">Buscar Lista de Produtos</button>
  <div id="lista"></div>

  <script>
    document.getElementById("btnBuscar").addEventListener("click", async () => {
      const listaDiv = document.getElementById("lista");
      listaDiv.textContent = "Carregando...";
      try {
        const resp = await fetch("/.netlify/functions/listarProdutos");
        const data = await resp.json();

        // Ver se hÃ¡ 'produto_servico_resumido' ou 'produto_servico_cadastro'
        if (data.produto_servico_resumido && data.produto_servico_resumido.length > 0) {
          // Exemplo no modo resumido
          const itens = data.produto_servico_resumido.map(
            (item) => `<li>${item.codigo} - ${item.descricao}</li>`
          );
          listaDiv.innerHTML = `<ul>${itens.join("")}</ul>`;
        }
        else if (data.produto_servico_cadastro && data.produto_servico_cadastro.length > 0) {
          // Exemplo no modo completo
          const itens = data.produto_servico_cadastro.map(
            (item) => `<li>${item.codigo} - ${item.descricao}</li>`
          );
          listaDiv.innerHTML = `<ul>${itens.join("")}</ul>`;
        }
        else {
          listaDiv.textContent = "Nenhum produto encontrado.";
        }
      } catch (err) {
        console.error(err);
        listaDiv.textContent = "Erro ao buscar: " + err.message;
      }
    });
  </script>
</body>
</html>
